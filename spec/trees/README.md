# vspecPreprocessor
The available CLI commands are displayed by the command:\
$ python3 vspecPreprocessor.py -h

which displays the following:
```
usage: python3 vspecPreprocessor.py [-h] -i INPUTFILE [-o OUTPUTFILE]
                                    [-s SCOPEFILE] [-v VSPECFILE]
                                    [-f {yaml,json,binary}]

The VspecPreprocessor tool configures the vspec files by creating
overlays to be submitted with the vspec files to VSS-tools

options:
  -h, --help            show this help message and exit
  -i INPUTFILE, --inputfile INPUTFILE
                        JSON file containing configuration data
  -o OUTPUTFILE, --outputfile OUTPUTFILE
                        Overlay vspec file to be used with VSS-tools
  -s SCOPEFILE, --scopefile SCOPEFILE
                        JSON file defining the scope of the different
                        config features
  -v VSPECFILE, --vspecfile VSPECFILE
                        Root vspec file of the tree
  -f {yaml,json,binary}, --format {yaml,json,binary}
                        Exporter output format
```
* The input file containing the wanted configuration is recommended to be in a domain subdirectory of the trees/Config directory.
* The output file containing the resulting overlay is recommended to be stored in the same domain subdirectory of the trees/Config directory as the input file.
* The scope file containing the available configuration alternatives is recommended to be stored in the same domain subdirectory of the trees/Config directory as the input file.
* The root vspec file of the domain tree to be configured by the overlay is optional. If present the vspecProcessor will display the CLI that will instruct the VSS-tools exporter to generate the tree.
* The format of the tree to be generated by the VSS-tools exporter is a part of the CLI. If not set to any of the avaliable alternatives it will by default be set to yaml.

# vspecPreprocessor CLI examples
The CV repo contains example files of both vspec trees and input configuration files as well as scope files.
Using these it is possible to generate first the overlay file for a specific configuration, which then can be as input together with the vspec tree files to generate a tree in any format supported by the VSS-tools exporters.\
Below follows some examples of this. The VSS-tools CLI contains a reference to the respective domain root vspec file. The default yaml output format is used.
* Create overlay for a truck.
```
$ python3 vspecPreprocessor.py -i Config/Truck/vehicleConfig-truck.json -o Config/Truck/truck.vspec -s Config/Truck/configScope.json -v Vehicle/Truck/TruckSignalSpecification.vspec

Overlay configuration saved to Config/Truck/truck.vspec

Exporter command: vspec export yaml -u Vehicle/Truck/units.yaml -q Vehicle/Truck/quantities.yaml -l Config/Truck/truck.vspec -s Vehicle/Truck/TruckSignalSpecification.vspec -o cvis.yaml
```
* Create overlay for a separate trailer.
```
$ python3 vspecPreprocessor.py -i Config/Trailer/vehicleConfig-separateTrailer.json -o Config/Trailer/separateTrailer.vspec -s Config/Trailer/configScope-separateTrailer.json -v Vehicle/Trailer/SeparateTrailerSignalSpecification.vspec

Overlay configuration saved to Config/Trailer/separateTrailer.vspec

Exporter command: vspec export yaml -u Vehicle/Trailer/units.yaml -q Vehicle/Trailer/quantities.yaml -l Config/Trailer/separateTrailer.vspec -s Vehicle/Trailer/SeparateTrailerSignalSpecification.vspec -o cvis.yaml
```
* Create overlay for multiple trailers in one tree.
```
$ python3 vspecPreprocessor.py -i Config/Trailer/vehicleConfig-multipleTrailers.json -o Config/Trailer/multipleTrailers.vspec -s Config/Trailer/configScope-multipleTrailers.json -v Vehicle/Trailer/MultipleTrailersSignalSpecification.vspec

Overlay configuration saved to Config/Trailer/multipleTrailers.vspec

Exporter command: vspec export yaml -u Vehicle/Trailer/units.yaml -q Vehicle/Trailer/quantities.yaml -l Config/Trailer/multipleTrailers.vspec -s Vehicle/Trailer/MultipleTrailersSignalSpecification.vspec -o cvis.yaml
```
* Create overlay for a passenger car.
```
python3 vspecPreprocessor.py -i Config/Car/vehicleConfig.json -o Config/Car/car.vspec -s Config/Car/configScope.json -v Vehicle/Car/VehicleSignalSpecification.vspec

Overlay configuration saved to Config/Car/car.vspec

Exporter command: vspec export yaml -u Vehicle/Car/units.yaml -q Vehicle/Car/quantities.yaml -l Config/Car/car.vspec -s Vehicle/Car/VehicleSignalSpecification.vspec -o cvis.yaml
```
